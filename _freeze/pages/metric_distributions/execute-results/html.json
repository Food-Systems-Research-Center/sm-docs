{
  "hash": "c9e69e3b1e1f5d0dc4d48e8577d055e4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Metric Distributions\"\nformat:\n  html:\n    fig-dpi: 200\neditor_options: \n  chunk_output_type: inline\nwarnings: false\n---\n\n\n\n\nThis page explores metric distributions before any transformations. Use this to inform how we might want to deal with outliers or normalize data at the metric level. \n\n\n\n\n\n\n\n\n\n# Distributions\n\nHighly skewed distributions might be good candidates for Box-Cox transformations or Winsorization. The figure below shows metrics with a skew \\> 2 in red, while those with a skew \\< 2 are in blue.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npacman::p_load(\n  ggplot2,\n  purrr,\n  ggpubr,\n  psych,\n  tibble\n)\n\n# Load metrics_df (created in refined_framework page)\nmetrics_df <- readRDS('data/metrics_df.rds')\n\n# Get skews of variables\nskewed <- psych::describe(metrics_df[, -1]) %>% \n  as.data.frame() %>% \n  rownames_to_column('variable_name') %>% \n  dplyr::select(variable_name, skew) %>% \n  dplyr::filter(abs(skew) > 2) %>% \n  pull(variable_name)\n\nplots <- map(names(metrics_df)[-1], \\(var){\n  # color based on skewness\n  if (var %in% skewed) {\n    fill <- 'red'\n    color <- 'darkred'\n  } else {\n    fill <- 'lightblue'\n    color <- 'royalblue'\n  }\n  \n  # Make plot for variable\n  metrics_df %>% \n    ggplot(aes(x = !!sym(var))) + \n    geom_density(\n      fill = fill,\n      color = color,\n      alpha = 0.5\n    ) +\n    theme_classic() +\n    theme(plot.margin = unit(c(rep(0.5, 4)), 'cm'))\n}) \n\n# Arrange them in 4 columns\nggarrange(\n  plotlist = plots,\n  ncol = 4,\n  nrow = 33\n)\n```\n\n::: {.cell-output-display}\n![Distributions of metrics at the state level.](metric_distributions_files/figure-html/metric_distributions-1.png){fig-align='center' width=2000}\n:::\n:::\n\n\n\n\nIt seems most of our metrics fall along respectable somewhat-normal distributions. 29 metrics are skewed out of 130 total. They include several variables related to local farm economies (agrotourism sales as a percentage of total sales, direct to consumer sales as a percentage of total sales, and value added sales as a percentage of total sales), as well as a couple of the TreeMap 2016 variables (dead standing carbon and live trees) and GHG emissions from agriculture (CH4 and CO2, with an honorable mention for N2O). Just about the whole collection of ERS metrics are skewed, including imports and exports, indemnities, and real estate expenses. \n\nThere might be a case for transformations here, or it might make more sense to do it at the indicator level. Another option is to weight our metrics to take into account population, number of farms, acres of farmland, GDP, or some other appropriate variable for each metric. @bene2019GlobalMapIndicators used Box Cox transformations for highly skewed indicators before normalizing all indicators with Min Max transformations. ",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}