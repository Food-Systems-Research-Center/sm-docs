<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Metric Distributions – Food Systems Research Center</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../pages/aggregation.html" rel="next">
<link href="../pages/refined_framework.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-84c4de9940dda03c3053f83edb5e97be.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://www.uvm.edu/cals/food-systems-research" class="navbar-brand navbar-brand-logo">
    <img src="../images/uvm_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://www.uvm.edu/cals/food-systems-research">
    <span class="navbar-title">Food Systems Research Center</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-tree"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.uvm.edu/cals/food-systems-research">
            FSRC
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.uvm.edu">
            UVM
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/Food-Systems-Research-Center/sm-docs">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/Food-Systems-Research-Center">
            FSRC GitHub
            </a>
          </li>
      </ul>
    </div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Metric Distributions</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Indicator Refinement</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refinement_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Process</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refine_economics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Economics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refine_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Environment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refine_production.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Production</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Secondary Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/metadata_table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/metrics_table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metrics Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/sm-explorer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SM-Explorer</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Refined Framework Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refined_framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Framework</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/metric_distributions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Metric Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/aggregation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aggregation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/indicator_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indicator Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comparisons</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/indicator_correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indicator Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selection and Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Validation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On This Page</h2>
   
  <ul>
  <li><a href="#distributions" id="toc-distributions" class="nav-link active" data-scroll-target="#distributions"><span class="header-section-number">1</span> Distributions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Metric Distributions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Explore metric distributions before normalization. Use this to inform how we might want to deal with outliers or normalize data at the metric level. For now, we are leaving the metrics as is, taking arithmetic means, and saving all normalization and weighting for the indicator level.</p>
<p>Transforming our data from long format to wide and making sure everything came through alright.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  dplyr,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  tidyr,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  tibble</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get latest year function</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'dev/data_pipeline_functions.R'</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load metrics data</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sm_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'data/sm_data.rds'</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load refined framework</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>raw_tree <span class="ot">&lt;-</span> sm_data[[<span class="st">'refined_tree'</span>]]</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Load refined framework</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>frame <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'data/frame.rds'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Join with metadata to double check the resolution of our metrics</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> sm_data<span class="sc">$</span>metadata</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># get_str(meta)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> frame <span class="sc">%&gt;%</span> </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable_name <span class="sc">!=</span> <span class="st">'NONE'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable_name) <span class="sc">%&gt;%</span> </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meta, <span class="at">by =</span> <span class="st">'variable_name'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># get_str(dat)</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull it from the actual metrics data</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> sm_data<span class="sc">$</span>metrics <span class="sc">%&gt;%</span> </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    variable_name <span class="sc">%in%</span> frame<span class="sc">$</span>variable_name,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    fips <span class="sc">%in%</span> sm_data<span class="sc">$</span>state_key<span class="sc">$</span>state_code</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># get_str(metrics)</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to latest year for each metric, and pivot wider</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Also removing census participation - don't really have data at state level</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Note to aggregate counties for this at some point</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>metrics_df <span class="ot">&lt;-</span> metrics <span class="sc">%&gt;%</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">==</span> <span class="st">'NaN'</span>, <span class="cn">NA</span>, value),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">str_remove_all</span>(value, <span class="st">','</span>),</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as.numeric</span>(value)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_latest_year</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">'variable_name'</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">'value'</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="sc">!</span>fips) <span class="sc">%&gt;%</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(metrics_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [51 × 130] (S3: tbl_df/tbl/data.frame)
 $ fips                                       : chr [1:51] "01" "02" "04" "05"..
 $ unemploymentRate_2022                      : num [1:51] 2.6 4 3.8 3.3 4.2 3..
 $ netReturnOperators_2023                    : num [1:51] 1561636000 -1598400..
 $ edPercBS_2022                              : num [1:51] 16.7 19.3 19.6 15.6..
 $ vacancyRate_2022                           : num [1:51] 15.84 18.95 11.58 1..
 $ gini_2022                                  : num [1:51] 0.48 0.43 0.461 0.4..
 $ poorMentalHealthDays_2024                  : num [1:51] 5.87 4.59 4.93 5.78..
 $ lowBirthweight_2024                        : num [1:51] 0.1048 0.0637 0.075..
 $ accessToExerciseOpportunities_2024         : num [1:51] 0.613 0.782 0.855 0..
 $ alcoholImpairedDrivingDeaths_2024          : num [1:51] 0.251 0.35 0.212 0...
 $ teenBirths_2024                            : num [1:51] 24.93 19.68 18.66 2..
 $ uninsured_2024                             : num [1:51] 0.1169 0.1318 0.131..
 $ primaryCarePhysicians_2024                 : num [1:51] 0.000637 0.000968 0..
 $ dentists_2024                              : num [1:51] 0.000496 0.001048 0..
 $ mentalHealthProviders_2024                 : num [1:51] 0.00135 0.00723 0.0..
 $ mammographyScreening_2024                  : num [1:51] 0.41 0.35 0.41 0.4 ..
 $ incomeInequality_2024                      : num [1:51] 5.21 4.16 4.4 4.8 5..
 $ childrenInSingleParentHouseholds_2024      : num [1:51] 0.306 0.207 0.252 0..
 $ socialAssociations_2024                    : num [1:51] 11.69 11.29 5.59 11..
 $ injuryDeaths_2024                          : num [1:51] 90.4 104.6 95.9 88...
 $ airPollutionParticulateMatter_2024         : num [1:51] 9.3 7.55 4.8 8.9 7...
 $ drinkingWaterViolations_2024               : num [1:51] 0.2239 0.64 0.8 0.2..
 $ severeHousingProblems_2024                 : num [1:51] 0.131 0.195 0.172 0..
 $ lifeExpectancy_2024                        : num [1:51] 73.7 77.1 77.5 74.3..
 $ prematureAgeAdjustedMortality_2024         : num [1:51] 549 412 411 527 319..
 $ infantMortality_2024                       : num [1:51] 7.73 5.92 5.48 7.77..
 $ frequentPhysicalDistress_2024              : num [1:51] 0.1237 0.1121 0.110..
 $ frequentMentalDistress_2024                : num [1:51] 0.196 0.142 0.159 0..
 $ diabetesPrevalence_2024                    : num [1:51] 0.133 0.08 0.097 0...
 $ hivPrevalence_2024                         : num [1:51] 339.7 124.3 296.4 2..
 $ limitedAccessToHealthyFoods_2024           : num [1:51] 0.0876 0.0787 0.086..
 $ drugOverdoseDeaths_2024                    : num [1:51] 21.6 25.1 32.7 17.3..
 $ disconnectedYouth_2024                     : num [1:51] 0.0802 0.1118 0.083..
 $ residentialSegregationBlackWhite_2024      : num [1:51] 57.4 57.2 49.8 65.2..
 $ suicides_2024                              : num [1:51] 16.23 27.7 18.61 19..
 $ motorVehicleCrashDeaths_2024               : num [1:51] 20.59 10.46 14.16 1..
 $ homeownership_2024                         : num [1:51] 0.697 0.663 0.663 0..
 $ severeHousingCostBurden_2024               : num [1:51] 0.1227 0.121 0.1342..
 $ broadbandAccess_2024                       : num [1:51] 0.838 0.894 0.892 0..
 $ schoolSegregation_2024                     : num [1:51] 0.275 0.245 0.234 0..
 $ genderPayGap_2024                          : num [1:51] 0.745 0.834 0.844 0..
 $ childCareCostBurden_2024                   : num [1:51] 0.266 0.249 0.307 0..
 $ childCareCenters_2024                      : num [1:51] 5.51 3.75 5.04 9.58..
 $ voterTurnout_2024                          : num [1:51] 0.626 0.675 0.671 0..
 $ nCSA_2023                                  : num [1:51] 0 0 1 0 7 0 1 1 0 2..
 $ nFarmersMarket_2023                        : num [1:51] 111 48 102 74 531 1..
 $ valueAddedFarmsPerc_2022                   : num [1:51] 0.01188 0.07673 0.0..
 $ agTourSalesPerc_2022                       : num [1:51] 0.00109 0.028531 0...
 $ d2cSalesPerc_2022                          : num [1:51] 0.001559 0.036544 0..
 $ valueAddedSalesPerc_2022                   : num [1:51] 0.00084 0.029697 0...
 $ localSalesPerc_2022                        : num [1:51] 0.004475 0.110765 0..
 $ nSnapGrocPTH_2017                          : num [1:51] 0.948 0.609 0.527 0..
 $ nGrocPTH_2016                              : num [1:51] 0.156 0.29 0.113 0...
 $ nWicsGrocPTH_2016                          : num [1:51] 0.14636 0.22252 0.1..
 $ snapPercPart_2020                          : num [1:51] 0.78 0.86 0.77 0.66..
 $ wicPercEligible_2021                       : num [1:51] 0.54 0.459 0.51 0.5..
 $ wicPercPart_2021                           : num [1:51] 0.498 0.513 0.517 0..
 $ medianEarnMaleFood_2021                    : num [1:51] 15361 21997 19966 1..
 $ medianEarnFemaleFood_2021                  : num [1:51] 13687 18592 16419 1..
 $ womenEarnPercMaleFood_2021                 : num [1:51] 0.891 0.845 0.822 0..
 $ medianEarnMaleFarm_2021                    : num [1:51] 30328 52472 29211 2..
 $ medianEarnFemaleFarm_2021                  : num [1:51] 25325 26250 14478 2..
 $ womenEarnPercMaleFarm_2021                 : num [1:51] 0.835 0.5 0.496 0.6..
 $ droughtMeanPercArea_2024                   : num [1:51] 56.64 2.25 81.28 45..
 $ lulcDiversity_2023                         : num [1:51] 2.005 NA 0.616 1.93..
 $ forestCarbonLive_2016                      : num [1:51] 67.6 NA 28.3 69 49...
 $ forestCarbonDeadStanding_2016              : num [1:51] 0.49 NA 0.974 0.857..
 $ forestCarbonDeadDown_2016                  : num [1:51] 2.425 NA 0.89 2.445..
 $ forestCanopyCover_2016                     : num [1:51] 21.11 NA 7.87 22.01..
 $ forestLiveTreeVolume_2016                  : num [1:51] 60 NA 24.8 60.2 67...
 $ forestLiveTrees_2016                       : num [1:51] 11.8 NA 20.9 15.3 2..
 $ forestDeadTrees_2016                       : num [1:51] 840 NA 247 766 321 ..
 $ forestStandHeight_2016                     : num [1:51] 1597 NA 847 1639 34..
 $ cropDiversity_2023                         : num [1:51] 1.914 NA 2.164 1.48..
 $ sppAnimals_2022                            : num [1:51] 2562 963 1978 1809 ..
 $ sppPlants_2022                             : num [1:51] 2967 1376 3540 2220..
 $ sppBees_2022                               : num [1:51] 47 43 241 48 310 22..
 $ sppOrchids_2022                            : num [1:51] 55 28 29 36 31 25 4..
 $ pctAtRiskAnimalSpp_2022                    : num [1:51] 23.61 7.59 18.18 13..
 $ pctAtRiskPlantSpp_2022                     : num [1:51] 9.847 5.939 16.177 ..
 $ pctAtRiskBeeSpp_2022                       : num [1:51] 10.64 15 22.47 12.5..
 $ pctAtRiskOrchidSpp_2022                    : num [1:51] 20 7.14 17.24 8.33 ..
 $ nEcosystems_2022                           : num [1:51] 64 66 70 42 105 82 ..
 $ pctAtRiskEcosystems_2022                   : num [1:51] 8.825 0 8.13 13.346..
 $ expHiredLaborPercOpExp_2022                : num [1:51] 4.9 35.4 14.8 5.3 1..
 $ farmIncomePF_2022                          : num [1:51] 17013 23601 49069 2..
 $ acresPF_2022                               : num [1:51] 231 742 1528 363 38..
 $ medianAcresPF_2022                         : num [1:51] 75 12 6 100 24 75 2..
 $ landValPF_2022                             : num [1:51] 845032 773460 13485..
 $ landValPerAcre_2022                        : num [1:51] 3659 1043 883 3921 ..
 $ expChemicalPct_2022                        : num [1:51] 2.9 0.8 4.8 8.1 5.7..
 $ salesAnimalPctSales_2022                   : num [1:51] 80.7 56.3 41.6 61.6..
 $ incForestProducts_2022                     : num [1:51] 72982000 33000 7900..
 $ ageProducers_2022                          : num [1:51] 58.7 56.7 60.1 57.6..
 $ producerRacialDiversity_2022               : num [1:51] 1.19 1.22 1.48 1.17..
 $ ftmProdRatio_2022                          : num [1:51] 0.541 0.879 0.919 0..
 $ geoexchangeNOps_2022                       : num [1:51] 121 6 1 256 123 383..
 $ methaneNOps_2022                           : num [1:51] 23 NA 8 7 48 17 4 1..
 $ solarNOps_2022                             : num [1:51] 699 184 1414 1200 1..
 $ windTurbinesNOps_2022                      : num [1:51] 58 19 91 24 312 573..
 $ waterIrrSrcOffFarmExp_2023                 : num [1:51] 104000 23000 586970..
 $ waterIrrSrcOffFarmExpPerAcreFt_2023        : num [1:51] 55.52 550 37.57 27...
 $ CH4FromAg_2022                             : num [1:51] 2.7067 0.0452 3.004..
 $ CO2FromAg_2022                             : num [1:51] 0.008008 0.003708 0..
 $ N2OFromAg_2022                             : num [1:51] 2.31024 0.01124 4.2..
 $ lakesLitripcvrCond_2022                    : num [1:51] 0.6 NA 0.673 0.806 ..
 $ lakesRvegCond_2022                         : num [1:51] 0.578 NA 0.582 0.86..
 $ riversNtlCond_2019                         : num [1:51] 0.6667 NA 0.5926 0...
 $ riversPtlCond_2019                         : num [1:51] 0.667 NA 0.481 0.48..
 $ riversRipvegCond_2019                      : num [1:51] 0.926 NA 0.667 0.48..
 $ riversSalCond_2019                         : num [1:51] 1 NA 0.852 1 0.927 ..
 $ propAreaFsaSecDisasters_2023               : num [1:51] 0.776 NA 1 0.711 1 ..
 $ importsTopFive_2024                        : num [1:51] 277.31 9.76 4295.76..
 $ exportsTotalAgricultural_2022              : num [1:51] 1702.5 20.6 1704.3 ..
 $ totalReceiptsAllForestProducts_2023        : num [1:51] 35637 300 952 9410 ..
 $ totalCapConsNoDwellings_2023               : num [1:51] 445663 8861 192329 ..
 $ totalIntExpRealEstateNoDwellings_2023      : num [1:51] 158524 1498 64839 2..
 $ totalValueServicesAndForestry_2023         : num [1:51] 1017904 18099 45391..
 $ totalIncomeInsuranceIndemnities_2023       : num [1:51] 115760 138 180265 3..
 $ totalIncomeInsuranceIndemnitiesFederal_2023: num [1:51] 108069 119 172816 2..
 $ totalValueEmergPayments_2023               : num [1:51] 54486 1115 28821 40..
 $ totalValueOtherAdHocEmergPayments_2023     : num [1:51] 49269 1032 26303 38..
 $ totalValueDairyMarginProtPayments_2023     : num [1:51] 394 0 6904 1028 127..
 $ totalValueAllLossCoveragePayments_2023     : num [1:51] 282 0 66 1763 106 1..
 $ totalValueAgRiskCoveragePayments_2023      : num [1:51] 15 0 0 624 189 1475..
 $ totalCapExpBldgsLandNoDwellings_2014       : num [1:51] 98943 2519 59687 13..
 $ sfaFarmToSchool_2023                       : num [1:51] 76.2 75 63.5 83.6 7..
 $ sfaCulturallyRelevant_2023                 : num [1:51] 16.85 32.14 11.81 1..
 $ sfaServeLocal_2023                         : num [1:51] 63.2 75 53.2 73.8 6..
 $ sfaLocalFoodCosts_2023                     : num [1:51] 6.55 2.6 20.82 21.9..</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's get rid of the years so they are easier to work with</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(metrics_df) <span class="ot">&lt;-</span> <span class="fu">str_split_i</span>(<span class="fu">names</span>(metrics_df), <span class="st">'_'</span>, <span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(metrics_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [51 × 130] (S3: tbl_df/tbl/data.frame)
 $ fips                                  : chr [1:51] "01" "02" "04" "05" "06"..
 $ unemploymentRate                      : num [1:51] 2.6 4 3.8 3.3 4.2 3 4.2 ..
 $ netReturnOperators                    : num [1:51] 1561636000 -15984000 128..
 $ edPercBS                              : num [1:51] 16.7 19.3 19.6 15.6 22.1..
 $ vacancyRate                           : num [1:51] 15.84 18.95 11.58 14.58 ..
 $ gini                                  : num [1:51] 0.48 0.43 0.461 0.482 0...
 $ poorMentalHealthDays                  : num [1:51] 5.87 4.59 4.93 5.78 4.65..
 $ lowBirthweight                        : num [1:51] 0.1048 0.0637 0.0754 0.0..
 $ accessToExerciseOpportunities         : num [1:51] 0.613 0.782 0.855 0.636 ..
 $ alcoholImpairedDrivingDeaths          : num [1:51] 0.251 0.35 0.212 0.271 0..
 $ teenBirths                            : num [1:51] 24.93 19.68 18.66 29.53 ..
 $ uninsured                             : num [1:51] 0.1169 0.1318 0.1313 0.1..
 $ primaryCarePhysicians                 : num [1:51] 0.000637 0.000968 0.0006..
 $ dentists                              : num [1:51] 0.000496 0.001048 0.0006..
 $ mentalHealthProviders                 : num [1:51] 0.00135 0.00723 0.00182 ..
 $ mammographyScreening                  : num [1:51] 0.41 0.35 0.41 0.4 0.36 ..
 $ incomeInequality                      : num [1:51] 5.21 4.16 4.4 4.8 5.16 4..
 $ childrenInSingleParentHouseholds      : num [1:51] 0.306 0.207 0.252 0.285 ..
 $ socialAssociations                    : num [1:51] 11.69 11.29 5.59 11.8 6...
 $ injuryDeaths                          : num [1:51] 90.4 104.6 95.9 88.9 58...
 $ airPollutionParticulateMatter         : num [1:51] 9.3 7.55 4.8 8.9 7.1 4.4..
 $ drinkingWaterViolations               : num [1:51] 0.2239 0.64 0.8 0.2667 0..
 $ severeHousingProblems                 : num [1:51] 0.131 0.195 0.172 0.131 ..
 $ lifeExpectancy                        : num [1:51] 73.7 77.1 77.5 74.3 79.9..
 $ prematureAgeAdjustedMortality         : num [1:51] 549 412 411 527 319 327 ..
 $ infantMortality                       : num [1:51] 7.73 5.92 5.48 7.77 4.18..
 $ frequentPhysicalDistress              : num [1:51] 0.1237 0.1121 0.1101 0.1..
 $ frequentMentalDistress                : num [1:51] 0.196 0.142 0.159 0.191 ..
 $ diabetesPrevalence                    : num [1:51] 0.133 0.08 0.097 0.109 0..
 $ hivPrevalence                         : num [1:51] 339.7 124.3 296.4 245.9 ..
 $ limitedAccessToHealthyFoods           : num [1:51] 0.0876 0.0787 0.0868 0.1..
 $ drugOverdoseDeaths                    : num [1:51] 21.6 25.1 32.7 17.3 22 2..
 $ disconnectedYouth                     : num [1:51] 0.0802 0.1118 0.0839 0.0..
 $ residentialSegregationBlackWhite      : num [1:51] 57.4 57.2 49.8 65.2 58 6..
 $ suicides                              : num [1:51] 16.23 27.7 18.61 19.35 1..
 $ motorVehicleCrashDeaths               : num [1:51] 20.59 10.46 14.16 19.69 ..
 $ homeownership                         : num [1:51] 0.697 0.663 0.663 0.662 ..
 $ severeHousingCostBurden               : num [1:51] 0.1227 0.121 0.1342 0.11..
 $ broadbandAccess                       : num [1:51] 0.838 0.894 0.892 0.824 ..
 $ schoolSegregation                     : num [1:51] 0.275 0.245 0.234 0.286 ..
 $ genderPayGap                          : num [1:51] 0.745 0.834 0.844 0.809 ..
 $ childCareCostBurden                   : num [1:51] 0.266 0.249 0.307 0.251 ..
 $ childCareCenters                      : num [1:51] 5.51 3.75 5.04 9.58 8.1 ..
 $ voterTurnout                          : num [1:51] 0.626 0.675 0.671 0.549 ..
 $ nCSA                                  : num [1:51] 0 0 1 0 7 0 1 1 0 2 0 2 ..
 $ nFarmersMarket                        : num [1:51] 111 48 102 74 531 140 13..
 $ valueAddedFarmsPerc                   : num [1:51] 0.01188 0.07673 0.01281 ..
 $ agTourSalesPerc                       : num [1:51] 0.00109 0.028531 0.00204..
 $ d2cSalesPerc                          : num [1:51] 0.001559 0.036544 0.0038..
 $ valueAddedSalesPerc                   : num [1:51] 0.00084 0.029697 0.00566..
 $ localSalesPerc                        : num [1:51] 0.004475 0.110765 0.0508..
 $ nSnapGrocPTH                          : num [1:51] 0.948 0.609 0.527 0.831 ..
 $ nGrocPTH                              : num [1:51] 0.156 0.29 0.113 0.161 0..
 $ nWicsGrocPTH                          : num [1:51] 0.14636 0.22252 0.10467 ..
 $ snapPercPart                          : num [1:51] 0.78 0.86 0.77 0.66 0.7 ..
 $ wicPercEligible                       : num [1:51] 0.54 0.459 0.51 0.587 0...
 $ wicPercPart                           : num [1:51] 0.498 0.513 0.517 0.35 0..
 $ medianEarnMaleFood                    : num [1:51] 15361 21997 19966 14375 ..
 $ medianEarnFemaleFood                  : num [1:51] 13687 18592 16419 13729 ..
 $ womenEarnPercMaleFood                 : num [1:51] 0.891 0.845 0.822 0.955 ..
 $ medianEarnMaleFarm                    : num [1:51] 30328 52472 29211 29462 ..
 $ medianEarnFemaleFarm                  : num [1:51] 25325 26250 14478 20289 ..
 $ womenEarnPercMaleFarm                 : num [1:51] 0.835 0.5 0.496 0.689 0...
 $ droughtMeanPercArea                   : num [1:51] 56.64 2.25 81.28 45.41 2..
 $ lulcDiversity                         : num [1:51] 2.005 NA 0.616 1.936 0 0..
 $ forestCarbonLive                      : num [1:51] 67.6 NA 28.3 69 49.5 39...
 $ forestCarbonDeadStanding              : num [1:51] 0.49 NA 0.974 0.857 3.04..
 $ forestCarbonDeadDown                  : num [1:51] 2.425 NA 0.89 2.445 4.73..
 $ forestCanopyCover                     : num [1:51] 21.11 NA 7.87 22.01 34.4..
 $ forestLiveTreeVolume                  : num [1:51] 60 NA 24.8 60.2 67.8 40 ..
 $ forestLiveTrees                       : num [1:51] 11.8 NA 20.9 15.3 22.3 3..
 $ forestDeadTrees                       : num [1:51] 840 NA 247 766 321 453 5..
 $ forestStandHeight                     : num [1:51] 1597 NA 847 1639 3419 15..
 $ cropDiversity                         : num [1:51] 1.914 NA 2.164 1.488 2.9..
 $ sppAnimals                            : num [1:51] 2562 963 1978 1809 2599 ..
 $ sppPlants                             : num [1:51] 2967 1376 3540 2220 5525..
 $ sppBees                               : num [1:51] 47 43 241 48 310 226 60 ..
 $ sppOrchids                            : num [1:51] 55 28 29 36 31 25 44 38 ..
 $ pctAtRiskAnimalSpp                    : num [1:51] 23.61 7.59 18.18 13.87 3..
 $ pctAtRiskPlantSpp                     : num [1:51] 9.847 5.939 16.177 3.869..
 $ pctAtRiskBeeSpp                       : num [1:51] 10.64 15 22.47 12.5 31.7..
 $ pctAtRiskOrchidSpp                    : num [1:51] 20 7.14 17.24 8.33 16.13..
 $ nEcosystems                           : num [1:51] 64 66 70 42 105 82 45 40..
 $ pctAtRiskEcosystems                   : num [1:51] 8.825 0 8.13 13.346 15.0..
 $ expHiredLaborPercOpExp                : num [1:51] 4.9 35.4 14.8 5.3 19.4 8..
 $ farmIncomePF                          : num [1:51] 17013 23601 49069 20843 ..
 $ acresPF                               : num [1:51] 231 742 1528 363 383 838..
 $ medianAcresPF                         : num [1:51] 75 12 6 100 24 75 20 36 ..
 $ landValPF                             : num [1:51] 845032 773460 1348526 14..
 $ landValPerAcre                        : num [1:51] 3659 1043 883 3921 13131..
 $ expChemicalPct                        : num [1:51] 2.9 0.8 4.8 8.1 5.7 2.8 ..
 $ salesAnimalPctSales                   : num [1:51] 80.7 56.3 41.6 61.6 27.2..
 $ incForestProducts                     : num [1:51] 72982000 33000 79000 293..
 $ ageProducers                          : num [1:51] 58.7 56.7 60.1 57.6 59.9..
 $ producerRacialDiversity               : num [1:51] 1.19 1.22 1.48 1.17 1.34..
 $ ftmProdRatio                          : num [1:51] 0.541 0.879 0.919 0.649 ..
 $ geoexchangeNOps                       : num [1:51] 121 6 1 256 123 383 71 4..
 $ methaneNOps                           : num [1:51] 23 NA 8 7 48 17 4 1 NA 3..
 $ solarNOps                             : num [1:51] 699 184 1414 1200 16403 ..
 $ windTurbinesNOps                      : num [1:51] 58 19 91 24 312 573 5 NA..
 $ waterIrrSrcOffFarmExp                 : num [1:51] 104000 23000 58697000 54..
 $ waterIrrSrcOffFarmExpPerAcreFt        : num [1:51] 55.52 550 37.57 27.24 71..
 $ CH4FromAg                             : num [1:51] 2.7067 0.0452 3.0047 10...
 $ CO2FromAg                             : num [1:51] 0.008008 0.003708 0.0121..
 $ N2OFromAg                             : num [1:51] 2.31024 0.01124 4.22545 ..
 $ lakesLitripcvrCond                    : num [1:51] 0.6 NA 0.673 0.806 0.769..
 $ lakesRvegCond                         : num [1:51] 0.578 NA 0.582 0.861 0.6..
 $ riversNtlCond                         : num [1:51] 0.6667 NA 0.5926 0.6667 ..
 $ riversPtlCond                         : num [1:51] 0.667 NA 0.481 0.481 0.7..
 $ riversRipvegCond                      : num [1:51] 0.926 NA 0.667 0.481 0.9..
 $ riversSalCond                         : num [1:51] 1 NA 0.852 1 0.927 0.906..
 $ propAreaFsaSecDisasters               : num [1:51] 0.776 NA 1 0.711 1 0.863..
 $ importsTopFive                        : num [1:51] 277.31 9.76 4295.76 161...
 $ exportsTotalAgricultural              : num [1:51] 1702.5 20.6 1704.3 4336 ..
 $ totalReceiptsAllForestProducts        : num [1:51] 35637 300 952 9410 4841 ..
 $ totalCapConsNoDwellings               : num [1:51] 445663 8861 192329 65901..
 $ totalIntExpRealEstateNoDwellings      : num [1:51] 158524 1498 64839 290920..
 $ totalValueServicesAndForestry         : num [1:51] 1017904 18099 453914 147..
 $ totalIncomeInsuranceIndemnities       : num [1:51] 115760 138 180265 305271..
 $ totalIncomeInsuranceIndemnitiesFederal: num [1:51] 108069 119 172816 280206..
 $ totalValueEmergPayments               : num [1:51] 54486 1115 28821 404521 ..
 $ totalValueOtherAdHocEmergPayments     : num [1:51] 49269 1032 26303 383390 ..
 $ totalValueDairyMarginProtPayments     : num [1:51] 394 0 6904 1028 127181 1..
 $ totalValueAllLossCoveragePayments     : num [1:51] 282 0 66 1763 106 19 0 0..
 $ totalValueAgRiskCoveragePayments      : num [1:51] 15 0 0 624 189 14755 0 2..
 $ totalCapExpBldgsLandNoDwellings       : num [1:51] 98943 2519 59687 131565 ..
 $ sfaFarmToSchool                       : num [1:51] 76.2 75 63.5 83.6 77.4 7..
 $ sfaCulturallyRelevant                 : num [1:51] 16.85 32.14 11.81 11.35 ..
 $ sfaServeLocal                         : num [1:51] 63.2 75 53.2 73.8 67 67...
 $ sfaLocalFoodCosts                     : num [1:51] 6.55 2.6 20.82 21.91 22...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save this for use in subsequent pages</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(metrics_df, <span class="st">'data/metrics_df.rds'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="distributions" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Distributions</h1>
<p>Here we explore univariate distributions of each of our metrics. Highly skewed distributions might be good candidates for Box-Cox transformations or Winsorization. The figure below shows metrics with a skew &gt; 2 in red, while those with a skew &lt; 2 are in blue.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  ggplot2,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  purrr,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  ggpubr,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  psych</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get skews of variables</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>skewed <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">describe</span>(metrics_df[, <span class="sc">-</span><span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">'variable_name'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable_name, skew) <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(skew) <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(variable_name)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">names</span>(metrics_df)[<span class="sc">-</span><span class="dv">1</span>], \(var){</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># color based on skewness</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (var <span class="sc">%in%</span> skewed) {</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    fill <span class="ot">&lt;-</span> <span class="st">'red'</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    color <span class="ot">&lt;-</span> <span class="st">'darkred'</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    fill <span class="ot">&lt;-</span> <span class="st">'lightblue'</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    color <span class="ot">&lt;-</span> <span class="st">'royalblue'</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make plot for variable</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  metrics_df <span class="sc">%&gt;%</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(var))) <span class="sc">+</span> </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> fill,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> color,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">4</span>)), <span class="st">'cm'</span>))</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>}) </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange them in 4 columns</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">plotlist =</span> plots,</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">33</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="metric_distributions_files/figure-html/metric_distributions-1.png" class="img-fluid figure-img" width="2000"></p>
<figcaption>Distributions of metrics at the state level.</figcaption>
</figure>
</div>
</div>
</div>
<p>It seems most of our metrics fall along respectable mostly-normal distributions. 18 of the 86 variables are skewed. They include several variables related to local farm economies (agrotourism sales as a percentage of total sales, direct to consumer sales as a percentage of total sales, and value added sales as a percentage of total sales), as well as a couple of the TreeMap 2016 variables (dead standing carbon and live trees) and GHG emissions from agriculture (CH4 and CO2, with an honorable mention for N2O). State agricultural imports and exports are also highly skewed.</p>
<p><span class="citation" data-cites="bene2019GlobalMapIndicators">Béné et al. (<a href="#ref-bene2019GlobalMapIndicators" role="doc-biblioref">2019</a>)</span> used Box Cox transformations for highly skewed indicators before normalizing all indicators with Min Max transformations. We will explore some of our options on the next page.</p>



</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bene2019GlobalMapIndicators" class="csl-entry" role="listitem">
Béné, Christophe, Steven D. Prager, Harold A. E. Achicanoy, Patricia Alvarez Toro, Lea Lamotte, Camila Bonilla, and Brendan R. Mapes. 2019. <span>“Global Map and Indicators of Food System Sustainability.”</span> <em>Scientific Data</em> 6 (1): 279. <a href="https://doi.org/10.1038/s41597-019-0301-5">https://doi.org/10.1038/s41597-019-0301-5</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../pages/refined_framework.html" class="pagination-link" aria-label="Framework">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Framework</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../pages/aggregation.html" class="pagination-link" aria-label="Aggregation">
        <span class="nav-page-text">Aggregation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>