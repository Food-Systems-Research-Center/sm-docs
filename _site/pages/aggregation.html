<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Metric Aggregation – Food Systems Research Center</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../pages/indicator_distributions.html" rel="next">
<link href="../pages/metric_distributions.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-84c4de9940dda03c3053f83edb5e97be.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="../site_libs/core-js-2.5.3/shim.min.js"></script>

<script src="../site_libs/react-18.2.0/react.min.js"></script>

<script src="../site_libs/react-18.2.0/react-dom.min.js"></script>

<script src="../site_libs/reactwidget-2.0.0/react-tools.js"></script>

<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">

<script src="../site_libs/reactable-binding-0.4.4/reactable.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://www.uvm.edu/cals/food-systems-research" class="navbar-brand navbar-brand-logo">
    <img src="../images/uvm_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://www.uvm.edu/cals/food-systems-research">
    <span class="navbar-title">Food Systems Research Center</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-tree"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.uvm.edu/cals/food-systems-research">
            FSRC
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.uvm.edu">
            UVM
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/Food-Systems-Research-Center/sm-docs">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/Food-Systems-Research-Center">
            FSRC GitHub
            </a>
          </li>
      </ul>
    </div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Metric Aggregation</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Indicator Refinement</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refinement_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Process</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refine_economics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Economics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refine_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Environment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refine_production.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Production</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Secondary Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/metadata_table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/metrics_table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metrics Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/sm-explorer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SM-Explorer</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Refined Framework</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/refined_framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Framework</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/metric_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metric Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/aggregation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Aggregation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/indicator_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indicator Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comparisons</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/indicator_correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indicator Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selection and Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Validation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On This Page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#imputation" id="toc-imputation" class="nav-link" data-scroll-target="#imputation"><span class="header-section-number">2</span> Imputation</a></li>
  <li><a href="#normalization" id="toc-normalization" class="nav-link" data-scroll-target="#normalization"><span class="header-section-number">3</span> Normalization</a></li>
  <li><a href="#directional-values" id="toc-directional-values" class="nav-link" data-scroll-target="#directional-values"><span class="header-section-number">4</span> Directional Values</a></li>
  <li><a href="#aggregation" id="toc-aggregation" class="nav-link" data-scroll-target="#aggregation"><span class="header-section-number">5</span> Aggregation</a></li>
  <li><a href="#wrangle" id="toc-wrangle" class="nav-link" data-scroll-target="#wrangle"><span class="header-section-number">6</span> Wrangle</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">7</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Metric Aggregation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Exploring methods of aggregating data into index and dimension scores. To Add:</p>
<ul>
<li>Primer on methods, cite <span class="citation" data-cites="oecdHandbookConstructingComposite2008">(<a href="#ref-oecdHandbookConstructingComposite2008" role="doc-biblioref">OECD 2008</a>)</span></li>
<li>Examples
<ul>
<li>cite Schneider <span class="citation" data-cites="schneider2023StateFoodSystems">(<a href="#ref-schneider2023StateFoodSystems" role="doc-biblioref">Schneider et al. 2023</a>)</span>
<ul>
<li>rank order comparisons only</li>
<li>compare to global weighted means by groups based on GDP</li>
<li>min max scaling to show distance from global groups</li>
</ul></li>
<li>cite Bene et al 2019 <span class="citation" data-cites="bene2019GlobalMapIndicators">(<a href="#ref-bene2019GlobalMapIndicators" role="doc-biblioref">Béné et al. 2019</a>)</span>
<ul>
<li>Box cox for most skewed indicators (skew &gt; 2)</li>
<li>then min max</li>
<li>geometric means for enviro and economic dimensions</li>
<li>arithmetic means for social and food dimensions</li>
<li>geometric mean for combining all four dimensions into one</li>
</ul></li>
<li>cite Nicoletti <span class="citation" data-cites="nicolettiSummaryIndicatorsProduct2000">(<a href="#ref-nicolettiSummaryIndicatorsProduct2000" role="doc-biblioref">Nicoletti 2000</a>)</span>
<ul>
<li>Use normaliaed square loadings (indicator weights) to weight each indicator</li>
</ul></li>
<li>cite Gomez Limon and Sanchez <span class="citation" data-cites="gomez-limon2010EmpiricalEvaluationAgricultural">(<a href="#ref-gomez-limon2010EmpiricalEvaluationAgricultural" role="doc-biblioref">Gómez-Limón and Sanchez-Fernandez 2010</a>)</span>
<ul>
<li>min max normalization</li>
<li>Aggregation - compared several different methods - mostly correlate, no big differences
<ul>
<li>weighted sum of indicators</li>
<li>product of weighted indicators</li>
<li>muilticriteria function based on distance to ideal point</li>
</ul></li>
<li>Weighting - did both PCA and analytic hierarchy process</li>
<li>Validation (identifying important factors) - double censored tobit - index as dependent, indicators as independent</li>
</ul></li>
<li>cite demelash and aremu <span class="citation" data-cites="adamudemelash2024MeasuringFoodSystem">(<a href="#ref-adamudemelash2024MeasuringFoodSystem" role="doc-biblioref">Adamu Demelash and Abate Alemu 2024</a>)</span>
<ul>
<li>Normalization - distance to reference
<ul>
<li>refernce determined by quartile analysis</li>
<li>not affected by outliers, extreme values</li>
</ul></li>
<li>Weighting - equal</li>
<li>Aggregation - linear</li>
<li>Additive method for indicators within dimensions</li>
<li>Geometric means for aggregate scores across four dimensions</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="imputation" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Imputation</h1>
<p>First, check how much missing data there are. If it is within reason, use missForest algorithm to impute missing data <span class="citation" data-cites="stekhovenMissForestNonparametricMissing2012a">(<a href="#ref-stekhovenMissForestNonparametricMissing2012a" role="doc-biblioref">Stekhoven and Bühlmann 2012</a>)</span>. This is particularly good at handling MAR data, and does a decent job at handling MNAR data and non-linear relationships as well. If less than 5% of data are missing, just about any method for handling it is reasonable, even listwise deletion <span class="citation" data-cites="beaujean2013">(<a href="#ref-beaujean2013" role="doc-biblioref">Beaujean 2013</a>)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  missForest,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  tibble</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>metrics_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'data/metrics_df.rds'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(metrics_df)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing data</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(metrics_df)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>mis_dat <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(metrics_df))<span class="sc">/</span>(<span class="fu">nrow</span>(metrics_df)<span class="sc">*</span>(<span class="fu">ncol</span>(metrics_df) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>mis_dat <span class="ot">&lt;-</span> <span class="fu">round</span>(mis_dat, <span class="dv">3</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Change fips from column to rowname so we can impute without losing it</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>metrics_df <span class="ot">&lt;-</span> metrics_df <span class="sc">%&gt;%</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">'fips'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(metrics_df)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute missing variables</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>mf_out <span class="ot">&lt;-</span> metrics_df <span class="sc">%&gt;%</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">missForest</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ntree =</span> <span class="dv">200</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry =</span> <span class="dv">10</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">variablewise =</span> <span class="cn">FALSE</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># get_str(mf_out)</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>(oob <span class="ot">&lt;-</span> mf_out<span class="sc">$</span>OOBerror)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># NRMSE 0.603</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Check missing again</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(mf_out<span class="sc">$</span>ximp)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks good</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Save just imputed data</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>imp_dat <span class="ot">&lt;-</span> mf_out<span class="sc">$</span>ximp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We had 1.537% missing data, which is rather little, and gives us flexibility in handling it. The out of bag error estimate from the missForest imputation algorithm was 0.518293.</p>
</section>
<section id="normalization" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Normalization</h1>
<p>We are normalizing our data using three methods: min-max, Box-Cox, and Z-scores. (We might also consider Winsorizing at some point.) Results will be saved to a list of three normalized datasets so we can compare outcomes of each one and see what the consequences are.</p>
<p><strong>Min Max</strong> <span class="citation" data-cites="oecdHandbookConstructingComposite2008">(<a href="#ref-oecdHandbookConstructingComposite2008" role="doc-biblioref">OECD 2008</a>)</span></p>
<p>Min-maxing scales all the data from 0 to 1 by subtracting the minimum value of each variable from all cases and dividing by the range of all cases in the variable. It is rather intuitive, as 1 is the best score, and 0 is the worst. This is a linear transformation, so the relationships between the values should not change.</p>
<p><span class="math display">\[\begin{equation}
I^t_qc = \frac{x^t_qc - min_c(x^{t_0}_q)}{max_c(x^{t_0}_q)-min_c(x^{t_0}_q)}
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(x^t_qc\)</span> is the metric <span class="math inline">\(q\)</span> for state <span class="math inline">\(c\)</span> at time <span class="math inline">\(t\)</span>.</p>
<p><strong>Z-Scores</strong> <span class="citation" data-cites="oecdHandbookConstructingComposite2008">(<a href="#ref-oecdHandbookConstructingComposite2008" role="doc-biblioref">OECD 2008</a>)</span></p>
<p>Z-scores are stardized to have a mean of 0 and a standard deviation of 1. Larger numbers are better, but there are no caps on the highest or lowest values. A value of 2 would mean that it is 2 standard deviations greater than the mean. Again, this is a linear transformation, so relationships between variables should not change.</p>
<p><span class="math display">\[\begin{equation}
I^t_{qc} = \frac{x^t_{qc}-x^t_{qc=\overline{c}}}{\sigma^t_{qc=\overline{c}}}
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(x^t_qc\)</span> is the metric <span class="math inline">\(q\)</span> for state <span class="math inline">\(c\)</span> at time <span class="math inline">\(t\)</span>.</p>
<p><strong>Box Cox</strong> <span class="citation" data-cites="bickel1981">(<a href="#ref-bickel1981" role="doc-biblioref">Bickel and Doksum 1981</a>)</span></p>
<p>Box-Cox transformations are non-linear transformations that use an optimal value of lambda to make the distribution as normal as possible. This has some strengths in that the data are easier to work with in further analyses. It also effectively pulls outliers inward toward the center of the distribution. However, it also changes relationships between the variables, so it will distort any bivariate correlations.</p>
<p><span class="math display">\[\begin{equation}
{\rm For}\ \lambda\neq0,\ f\lambda(x) = (sign(x)|x|^\lambda-1)/\lambda
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
{\rm For}\ \lambda = 0,\ f_0(x) = log(x)
\end{equation}\]</span></p>
<div class="cell" data-warnings="false">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  forecast</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># List of results</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>normed <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get_str(imp_dat)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Z scores</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>normed<span class="sc">$</span>zscore <span class="ot">&lt;-</span> imp_dat <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(.x, <span class="at">scale =</span> <span class="cn">TRUE</span>, <span class="at">center =</span> <span class="cn">TRUE</span>))))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Min Max</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>min_max <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>normed<span class="sc">$</span>minmax <span class="ot">&lt;-</span> imp_dat <span class="sc">%&gt;%</span> </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), min_max))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Box Cox. Adding 1 as constant to remove zeroes</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>normed<span class="sc">$</span>boxcox <span class="ot">&lt;-</span> imp_dat <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">BoxCox</span>(.x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="st">'auto'</span>)))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># map(normed, get_str)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="directional-values" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Directional Values</h1>
<p>Here, we are assuming that each metric has a direction that is more sustainable than the opposite. Either more of it is better, or less of it is better. This is rather problematic in that just about any metric becomes negative with too much or too little of it. What might make more sense in the long run would be to consult the expertise of our teams and develop acceptable ranges for some metrics once they are settled. Still, just about every sustainability indicator framework does some variation of this one-way value system <span class="citation" data-cites="schneider2023StateFoodSystems bene2019GlobalMapIndicators nicolettiSummaryIndicatorsProduct2000 jacobi2020NewUnderstandingEvaluation gomez-limon2010EmpiricalEvaluationAgricultural">(<a href="#ref-schneider2023StateFoodSystems" role="doc-biblioref">Schneider et al. 2023</a>; <a href="#ref-bene2019GlobalMapIndicators" role="doc-biblioref">Béné et al. 2019</a>; <a href="#ref-nicolettiSummaryIndicatorsProduct2000" role="doc-biblioref">Nicoletti 2000</a>; <a href="#ref-jacobi2020NewUnderstandingEvaluation" role="doc-biblioref">Jacobi et al. 2020</a>; <a href="#ref-gomez-limon2010EmpiricalEvaluationAgricultural" role="doc-biblioref">Gómez-Limón and Sanchez-Fernandez 2010</a>)</span>.</p>
<p>Alas, for now, we will invert variables in each of the transformed datasets as necessary so that larger numbers are more sustainable, and smaller numbers are less sustainable. The table below shows this assignment in the <code>desired_direction</code> column. For couple of variables (vacancy rate and animal sales as a percentage of all agricultural sales) I was not comfortable assigning one direction as better than the other, so I have removed them from the refined framework.</p>
<div class="cell" data-warnings="false">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  reactable</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># map(normed, get_str)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># names(normed[[1]])</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher numbers should be better. Reverse metrics that are the opposite, where lower numbers are better:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>reverse <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">'unemploymentRate'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">'gini'</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">'lowBirthweight'</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">'teenBirths'</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">'uninsured'</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">'incomeInequality'</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">'injuryDeaths'</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">'drinkingWaterViolations'</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">'prematureAgeAgjustedMortality'</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">'infantMortality'</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">'foodInsecurity'</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">'drugOverdoseDeaths'</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">'disconnectedYouth'</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">'residentialSegregationBlackWhite'</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">'motorVehicleCrashDeaths'</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">'severeHousingCostBurden'</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">'schoolSegregation'</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">'foodInsecOverall'</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">'foodInsecChild'</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">'droughtMeanPercArea'</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">'expChemicalPct'</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">'waterIrrSrcOffFarmExpPerAcreFt'</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ageProducers'</span> <span class="co"># Could be better to use age diversity?</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Some are unclear - without clear direction, better to remove:</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>remove <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">'vacancyRate'</span>,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">'salesAnimalPctSales'</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove from all three datasets</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>normed <span class="ot">&lt;-</span> <span class="fu">map</span>(normed, <span class="sc">~</span> {</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  .x <span class="sc">%&gt;%</span> </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">matches</span>(remove))</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co"># map(normed, get_str)</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Show table of which metrics were set in which direction</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'data/sm_data.rds'</span>)[[<span class="st">'metadata'</span>]]</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Reactable table showing var, metric, source, and direction</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span> </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable_name <span class="sc">%in%</span> <span class="fu">names</span>(imp_dat)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">desired_direction =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    variable_name <span class="sc">%in%</span> reverse <span class="sc">~</span> <span class="st">'Lower'</span>,</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    variable_name <span class="sc">%in%</span> remove <span class="sc">~</span> <span class="st">'Removed'</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> <span class="st">'Higher'</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(metric, definition, variable_name, desired_direction, source)</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reactable</span>(</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">pagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">wrap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">onClick =</span> <span class="st">'select'</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>),</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">defaultPageSize =</span> <span class="dv">5</span>,</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"14px"</span>),</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">compact =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">fullWidth =</span> <span class="cn">TRUE</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-59af3e4a347cca8c5be5" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-59af3e4a347cca8c5be5">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"metric":["Unemployment Rate","Percentage with bachelor's degree","Rental vacancy rate","Gini Index","Alcohol-impaired driving deaths","Children in single-parent households","Disconnected youth","Residential segregation - black/white","School segregation","Social associations","Voter turnout","Broadband access","Gender pay gap","Income inequality","Access to exercise opportunities","Air pollution - particulate matter","Child care centers","Child care cost burden","Dentists","Diabetes prevalence","Drinking water violations","Drug overdose deaths","Frequent mental distress","Frequent physical distress","Hiv prevalence","Homeownership","Infant mortality","Injury deaths","Life expectancy","Limited access to healthy foods","Low birthweight","Mammography screening","Mental health providers","Motor vehicle crash deaths","Poor mental health days","Premature age-adjusted mortality","Primary care physicians","Severe housing cost burden","Severe housing problems","Suicides","Teen births","Uninsured","Agritourism, sales as a percent of all farm sales","Farms, direct-to-consumer sales as a percent of all farm sales","Farms, local marketing channel sales as a percent of all farm sales","Community Supported Agriculture (CSA), number of businesses","Farmers markets, number of businesses","Farms, percent of all farms with value-added sales","Farms, value-added sales as a percent of all farm sales","Grocery stores/1,000 pop","SNAP participation rates, all eligible people","SNAP-authorized stores/1,000 pop","WIC coverage rate","WIC eligibility rate","WIC-authorized stores/1,000 pop","Median earnings (dollars) for female, farming, fishing, and forestry occupations","Median earnings (dollars) for female, food preparation and serving related occupations","Median earnings (dollars) for male, farming, fishing, and forestry occupations","Median earnings (dollars) for male, food preparation and serving related occupations","Women's earnings as a percentage of men's earning, farming, fishing, and forestry occupations","Women's earnings as a percentage of men's earning, food preparation and serving related occupations","Mean percent area in drought","Mean percent area in drought","Forest canopy cover","Forest carbon - dead and down","Forest carbon - standing dead","Forest carbon - live standing","Dead trees per forested acre","Live trees per forested acre","Forest live tree volume per acre","Forest stand height","Crop diversity","Total number of ecosystems","Percentage of animal species at risk","Percentage of bee species at risk","Percentage of ecosystems at risk","Percentage of orchid species at risk","Percentage of plant species at risk","Total number of animal species","Total number of bee species","Total number of orchid species","Total number of plant species","Labor expenses as percentage of expenses","Mean farm related income per operation","Mean acres per farm","Median acres per farm","Land and building value per farm","Land and building value per acre","Mean chemical expenses per operation","Animal sales as a percentage of farm sales","Total forest product income","Mean producer age","Ratio of female to male producers","Racial diversity of producers","Operations using geoexchange","Operations using methane energy","Operations with solar power","Expenses from water for irrigation sourced off-farm per acre foot","Operations with wind turbines","Total CH4 emissions from agriculture (Tg)","Total CO2 emissions from agriculture (Tg)","Total N2O emissions from agriculture (Tg)","Lake habitat complexity condition class","Riparian vegetation condition class","Site condition class based on total nitrogen concentration","Site condition class based on total phosphorus concentration","Riparian vegetation condition, based on L_XCMGW","Site condition class based on conductivity","Proportion of area affected by FSA Agriculture Secretary disaster declaration","Value of total agricultural exports","value of top five imports","Capital consumption, all, excl. operator dwellings","Cash receipts value, forest products , all","Interest expenses, real estate, excl. operator dwellings","Other farm income, insurance indemnities","Other farm income, insurance indemnities, federal","Value of ad hoc and emergency program payments, all","Value of agricultural risk coverage payments, all","Value of all other ad hoc and emergency program payments","Value of dairy margin protection program payments","Value of price loss coverage payments, all","Value of production, services and forestry, all","SFAs serving culturally relevant food","SFAs with Farm to School program","SFAs percentage of spending on local food","SFAs serving local food"],"definition":["Number of unemployed people as percentage of labor force: (Unemployed / Labor Force) * 100","Percentage of population age 25 or older with bachelor's degree","Vacancy rate, rentals","Gini Index of income inequality. 0 is perfect inequality, while 1 is perfect inequality","Percentage of driving deaths with alcohol involvement.","Percentage of children that live in a household headed by a single parent.","Percentage of teens and young adults ages 16-19 who are neither working nor in school.","Index of dissimilarity where higher values indicate greater residential segregation between Black and white\ncounty residents.","The extent to which students within different race and ethnicity groups are unevenly distributed across\nschools when compared with the racial and ethnic composition of the local population. The index ranges\nfrom 0 to 1 with lower values representing a school composition that approximates race and ethnicity\ndistributions in the student populations within the county, and higher values representing more segregation.","Number of membership associations per 10,000 population.","Percentage of citizen population aged 18 or older who voted in the 2020 U.S. Presidential election.","Percentage of households with broadband internet connection.","Ratio of women's median earnings to men's median earnings for all full-time, year-round workers, presented\nas &quot;cents on the dollar.&quot;","Ratio of household income at the 80th percentile to income at the 20th percentile.","Percentage of population with adequate access to locations for physical activity.","Average daily density of fine particulate matter in micrograms per cubic meter (PM2.5).","Number of child care centers per 1,000 population under 5 years old.","Child care costs for a household with two children as a percent of median household income.","Number of dentists per 100,000 population","Percentage of adults aged 20 and above with diagnosed diabetes (age-adjusted).","Indicator of the presence of health-related drinking water violations. 0=No, 1=Yes","Number of drug poisoning deaths per 100,000 population.","Percentage of adults reporting 14 or more days of poor mental health per month (age-adjusted).","Percentage of adults reporting 14 or more days of poor physical health per month (age-adjusted).","Number of people aged 13 years and older living with a diagnosis of human immunodeficiency virus (HIV)\ninfection per 100,000 population.","Percentage of owner-occupied housing units.","Number of infant deaths (within 1 year) per 1,000 live births.","Number of deaths due to injury per 100,000 population.","Average number of years a person can expect to live.","Percentage of population who are low-income and do not live close to a grocery store.","Percentage of live births with low birthweight (< 2,500 grams).","Percentage of female Medicare enrollees ages 65-74 that received an annual mammography screening.","Number of mental health care providers per 100,000 population","Number of motor vehicle crash deaths per 100,000 population.","Average number of mentally unhealthy days reported in past 30 days (age-adjusted).","Number of deaths among residents under age 75 per 100,000 population (age-adjusted).","Number of primary care physicians per 100,000 population","Percentage of households that spend 50% or more of their household income on housing.","Percentage of households with at least 1 of 4 housing problems: overcrowding, high housing costs, lack of\nkitchen facilities, or lack of plumbing facilities.","Number of deaths due to suicide per 100,000 population (age-adjusted).","Number of births per 1,000 female population ages 15-19.","Percentage of population under age 65 without health insurance.","Income from agritourism and recreational services as a percent of all farm sales","Direct-to-consumer sales (e.g., farmers markets, community supported agriculture, farm stands) as a percent of all farm sales","Sales thorugh local marketing channel (e.g., farmers markets, community supported agriculture, farm stands, restaurants, grocery stores, schools, hospitals, regional food aggregators) as a percent of all farm sales","Number of community Supported Agriculture (CSA) businesses. Data is self reported and not representative of all CSA businesses.","Number of farmers markets. Data is self reported and not representative of all farmers markets.","Percent of all farms with value-added sales (includes commodity and local sales)","Value-added sales (includes commodity and local sales) as a percent of all farm sales","Number of grocery stores/1,000 pop in a county","Percent of eligible people participating in SNAP","Number of snap-authorized stores/1,000 pop in a county","Percent of eligible people who participated in WIC","Percent of population who were eligible to participate in WIC","Number of wic-authorized stores/1,000 pop in a county","Median earnings (dollars) for female, Civilian employed population 16 years and over with earnings, Farming, fishing, and forestry occupations","Median earnings (dollars) for female, Civilian employed population 16 years and over with earnings, Food preparation and serving related occupations","Median earnings (dollars) for male, Civilian employed population 16 years and over with earnings, Farming, fishing, and forestry occupations","Median earnings (dollars) for male, Civilian employed population 16 years and over with earnings, Food preparation and serving related occupations","Females' earnings as a percentage of males' earnings, Civilian employed population 16 years and over with earnings, Farming, fishing, and forestry occupations","Females' earnings as a percentage of males' earnings, Civilian employed population 16 years and over with earnings, Food preparation and serving related occupations","Mean of weekly percentages of area that under a drought, as defined by the US Drought Monitor (below 20th percentile for most indicators)","Mean of weekly percentages of area that under a drought, as defined by the US Drought Monitor (below 20th percentile for most indicators)","Mean live Canopy cover percentage derived from the Forest Vegatation Simulator","Mean carbon (tons per acre) of woody material greater than 3 inches in diameter on the ground, and stumps and their roots greater than 3 inches in diameter. Estimated from models based on geographic area, forest type, and live tree carbon density (Smith and Heath 2008).","Mean carbon, standing dead (tons per acre).","Mean carbon, live above ground (tons per acre).","Number of live trees (diamater > 5 inches) per acre","Number of standing dead trees (diamater > 5 inches) per acre","Mean volume, live, cubic feet per acre.","Height of dominant trees, in feet, derivedf from the Forest Vegatation Simulator","Shannon diversity index of crop types based on USDA Cropland Data Layer. Forests, grasslands, developed areas and open water were removed before calculations.","Number of ecosystems represented in state based on the US National Vegetation Classification from 2022","Percentage of animal species within state that are at risk of extinction (vulnerable, imperiled, critically imperiled, or possibly extinct)","Percentage of bee species within state that are at risk of extinction (vulnerable, imperiled, critically imperiled, or possibly extinct)","Percentage of ecosystems within state that are at risk (vulnerable, imperiled, or critically imperiled)","Percentage of orchid species within state that are at risk of extinction (vulnerable, imperiled, critically imperiled, or possibly extinct)","Percentage of plant species within state that are at risk of extinction (vulnerable, imperiled, critically imperiled, or possibly extinct)","Total number of animal species within state","Total number of bee species within state","Total number of orchid species within state","Total number of plant species within state","Hired labor expenses as a percentage of total operating expenses","Income, farm-related - receipts, measured in $ / operation","Mean acres operated per farm","Median acres operated per farm","Value of agricultural land, including buildings, per operation","Value of agricultural land, including buildings, per acre","Total chemical expenses / number of operations with chemical expenses","Animal sales as a percentage of total farm sales","Income from farm-related forest products, exclusing Christmas trees, short term woody crops, and maple syrup","Mean producer age","Ratio of female to male producers","Shannon index of NASS producer race statistics","Operations using geoexchange","Operations using methane energy","Operations with solar power","Expenses from water for irrigation sourced off-farm per acre foot","Operations with wind turbines","Total CH4 emissions from agriculture (Tg)","Total CO2 emissions from agriculture (Tg)","Total N2O emissions from agriculture (Tg)","Qualitative ratings recoded to 1 (Good, Fair) and 0 (Poor) and averaged by state","Qualitative ratings recoded to 1 (Good, Fair) and 0 (Poor) and averaged by state","Qualitative ratings recoded to 1 (Good, Fair) and 0 (Poor) and averaged by state","Qualitative ratings recoded to 1 (Good, Fair) and 0 (Poor) and averaged by state","Qualitative ratings recoded to 1 (Good, Fair) and 0 (Poor) and averaged by state","Qualitative ratings recoded to 1 (Good, Fair) and 0 (Poor) and averaged by state","Proportion of area within a state affected by FSA Agriculture Secretary disaster declarations. Declarations are made at the county level, so the area of each county affected is summed and divided by the area of the state.","Value (in millions) of total agricultural exports","Value (in millions) of imports for top five agricultural commodity groups from outside of the United States. Note that this is not total imports, nor does it include imports from other states.","Capital consumption, all, excl. operator dwellings","Cash receipts value, forest products , all","Interest expenses, real estate, excl. operator dwellings","Other farm income, insurance indemnities","Other farm income, insurance indemnities, federal","Value of ad hoc and emergency program payments, all","Value of agricultural risk coverage payments, all","Value of all other ad hoc and emergency program payments","Value of dairy margin protection program payments","Value of price loss coverage payments, all","Value of production, services and forestry, all","Percentage of all School Food Authorities growing or serving culturally relevant foods.","Percentage of all School Food Authorities participating in a Farm to School program.","Percentage of total food costs spent on local foods among School Food Authorities which participate in a Farm to School program.","Percentage of all School Food Authorities serving local foods. Note that the definition of \"local\" can very by SFA."],"variable_name":["unemploymentRate","edPercBS","vacancyRate","gini","alcoholImpairedDrivingDeaths","childrenInSingleParentHouseholds","disconnectedYouth","residentialSegregationBlackWhite","schoolSegregation","socialAssociations","voterTurnout","broadbandAccess","genderPayGap","incomeInequality","accessToExerciseOpportunities","airPollutionParticulateMatter","childCareCenters","childCareCostBurden","dentists","diabetesPrevalence","drinkingWaterViolations","drugOverdoseDeaths","frequentMentalDistress","frequentPhysicalDistress","hivPrevalence","homeownership","infantMortality","injuryDeaths","lifeExpectancy","limitedAccessToHealthyFoods","lowBirthweight","mammographyScreening","mentalHealthProviders","motorVehicleCrashDeaths","poorMentalHealthDays","prematureAgeAdjustedMortality","primaryCarePhysicians","severeHousingCostBurden","severeHousingProblems","suicides","teenBirths","uninsured","agTourSalesPerc","d2cSalesPerc","localSalesPerc","nCSA","nFarmersMarket","valueAddedFarmsPerc","valueAddedSalesPerc","nGrocPTH","snapPercPart","nSnapGrocPTH","wicPercPart","wicPercEligible","nWicsGrocPTH","medianEarnFemaleFarm","medianEarnFemaleFood","medianEarnMaleFarm","medianEarnMaleFood","womenEarnPercMaleFarm","womenEarnPercMaleFood","droughtMeanPercArea","droughtMeanPercArea","forestCanopyCover","forestCarbonDeadDown","forestCarbonDeadStanding","forestCarbonLive","forestDeadTrees","forestLiveTrees","forestLiveTreeVolume","forestStandHeight","cropDiversity","nEcosystems","pctAtRiskAnimalSpp","pctAtRiskBeeSpp","pctAtRiskEcosystems","pctAtRiskOrchidSpp","pctAtRiskPlantSpp","sppAnimals","sppBees","sppOrchids","sppPlants","expHiredLaborPercOpExp","farmIncomePF","acresPF","medianAcresPF","landValPF","landValPerAcre","expChemicalPct","salesAnimalPctSales","incForestProducts","ageProducers","ftmProdRatio","producerRacialDiversity","geoexchangeNOps","methaneNOps","solarNOps","waterIrrSrcOffFarmExpPerAcreFt","windTurbinesNOps","CH4FromAg","CO2FromAg","N2OFromAg","lakesLitripcvrCond","lakesRvegCond","riversNtlCond","riversPtlCond","riversRipvegCond","riversSalCond","propAreaFsaSecDisasters","exportsTotalAgricultural","importsTopFive","totalCapConsNoDwellings","totalReceiptsAllForestProducts","totalIntExpRealEstateNoDwellings","totalIncomeInsuranceIndemnities","totalIncomeInsuranceIndemnitiesFederal","totalValueEmergPayments","totalValueAgRiskCoveragePayments","totalValueOtherAdHocEmergPayments","totalValueDairyMarginProtPayments","totalValueAllLossCoveragePayments","totalValueServicesAndForestry","sfaCulturallyRelevant","sfaFarmToSchool","sfaLocalFoodCosts","sfaServeLocal"],"desired_direction":["Lower","Higher","Removed","Lower","Higher","Higher","Lower","Lower","Lower","Higher","Higher","Higher","Higher","Lower","Higher","Higher","Higher","Higher","Higher","Higher","Lower","Lower","Higher","Higher","Higher","Higher","Lower","Lower","Higher","Higher","Lower","Higher","Higher","Lower","Higher","Higher","Higher","Lower","Higher","Higher","Lower","Lower","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Lower","Lower","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Lower","Removed","Higher","Lower","Higher","Higher","Higher","Higher","Higher","Lower","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher","Higher"],"source":["U.S. Department of Labor, Bureau of Labor Statistics, Local Area Unemployment Statistics (LAUS)","U.S. Census Bureau, American Community Survey: 5-Year Estimates: Detailed Tables, 2022","U.S. Census Bureau, American Community Survey: 5-Year Estimates: Detailed Tables, 2022","U.S. Census Bureau, American Community Survey: 5-Year Estimates: Detailed Tables, 2022.","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","University of Wisconsin Population Health Institute, County Health Rankings and Roadmaps. (2024)","U.S. Department of Agriculture, National Agricultural Statistical Survey, Census of Agriculture","U.S. Department of Agriculture, National Agricultural Statistical Survey, Census of Agriculture","U.S. Department of Agriculture, National Agricultural Statistical Survey, Census of Agriculture","U.S. Department of Agriculture, Local Food Directories","U.S. Department of Agriculture, Local Food Directories","U.S. Department of Agriculture, National Agricultural Statistical Survey, Census of Agriculture","U.S. Department of Agriculture, National Agricultural Statistical Survey, Census of Agriculture","U.S. Department of Agriculture, Economic Research Service, Food Environment Atlas, Food Environment Atlas","U.S. Department of Agriculture, Food and Nutrition Service, Supplemental Nutrition Assistance Program (SNAP)","U.S. Department of Agriculture, Economic Research Service, Food Environment Atlas, Food Environment Atlas","U.S. Department of Agriculture, Food and Nutrition Service","U.S. Department of Agriculture, Food and Nutrition Service","U.S. Department of Agriculture, Economic Research Service, Food Environment Atlas, Food Environment Atlas","U.S.Census Bureau, American Community Survey","U.S.Census Bureau, American Community Survey","U.S.Census Bureau, American Community Survey","U.S.Census Bureau, American Community Survey","U.S.Census Bureau, American Community Survey","U.S.Census Bureau, American Community Survey","U.S. Department of Agriculture, U.S. Drought Monitor. (2024).","U.S. Department of Agriculture, U.S. Drought Monitor. (2024).","TreeMap 2016: A tree-level model of the forests of the conterminous United States circa 2016","TreeMap 2016: A tree-level model of the forests of the conterminous United States circa 2016","TreeMap 2016: A tree-level model of the forests of the conterminous United States circa 2016","TreeMap 2016: A tree-level model of the forests of the conterminous United States circa 2016","TreeMap 2016: A tree-level model of the forests of the conterminous United States circa 2016","TreeMap 2016: A tree-level model of the forests of the conterminous United States circa 2016","TreeMap 2016: A tree-level model of the forests of the conterminous United States circa 2016","TreeMap 2016: A tree-level model of the forests of the conterminous United States circa 2016","U.S. Department of Agriculture, National Agricultural Statistics Service, Cropland Data Layer","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","NatureServe Network. (2023). Biodiversity in Focus: United States Edition. Arlington, VA.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Department of Agriculture, National Agricultural Statistics Service. (2024). 2022 Census of Agriculture.","U.S. Environmental Protection Agency State GHG Data (2024).","U.S. Environmental Protection Agency State GHG Data (2024).","U.S. Environmental Protection Agency State GHG Data (2024).","U.S. Environmental Protection Agency, National Aquatic Resource Surveys, 2022","U.S. Environmental Protection Agency, National Aquatic Resource Surveys, 2022","U.S. Environmental Protection Agency, National Aquatic Resource Surveys, 2022","U.S. Environmental Protection Agency, National Aquatic Resource Surveys, 2022","U.S. Environmental Protection Agency, National Aquatic Resource Surveys, 2022","U.S. Environmental Protection Agency, National Aquatic Resource Surveys, 2022","U.S. Department of Agriculture, Farm Service Agency Disaster Assistance","US Department of Agriculture, Economic Research Service, State Agricultural Trade Data, State Exports","US Department of Agriculture, Economic Research Service, State Agricultural Trade Data, State Trade by Country of Origin and Destination","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture, Economic Research Service. (2025, February 6). Farm Income and Wealth Statistics.","U.S. Department of Agriculture Food and Nutrition Service Farm to School Program Census (2023).","U.S. Department of Agriculture Food and Nutrition Service Farm to School Program Census (2023).","U.S. Department of Agriculture Food and Nutrition Service Farm to School Program Census (2023).","U.S. Department of Agriculture Food and Nutrition Service Farm to School Program Census (2023)."]},"columns":[{"id":"metric","name":"metric","type":"character"},{"id":"definition","name":"definition","type":"character"},{"id":"variable_name","name":"variable_name","type":"character"},{"id":"desired_direction","name":"desired_direction","type":"character"},{"id":"source","name":"source","type":"character"}],"resizable":true,"filterable":true,"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,25,50,100],"onClick":"select","highlight":true,"bordered":true,"striped":true,"compact":true,"style":{"fontSize":"14px"},"dataKey":"3552b21f03922f95bfe34fa66513f8ae"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="aggregation" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Aggregation</h1>
<p>Here we are combining values in each indicator, index, and dimension using both arithmetic and geometric means <span class="citation" data-cites="oecdHandbookConstructingComposite2008">(<a href="#ref-oecdHandbookConstructingComposite2008" role="doc-biblioref">OECD 2008</a>)</span>. Arithmetic means are fully compensable, in that a strong score in one area can make up for a weak score in another. Geometric means are only somewhat compensable - it effectively applies a penalty for unbalanced scores.</p>
<p>We might also consider PCA here, as we have done with the preliminary dimension metrics previously. But the n:p ratio is not in our favor for PCA as we have more metrics than states. Will revisit this, perhaps by splitting it up into dimensions again rather than trying the whole framework at once, or possible using a sparse PCA procedure that incorporates variable selection.</p>
<p>We will end up with 6 iterations of our data (3 normalization methods * 2 aggregation methods).</p>
<p>Indicator Means:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to attach these back to framework from metadata</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter frame from earlier down to our current metrics</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>frame <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'data/frame.rds'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>filtered_frame <span class="ot">&lt;-</span> frame <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable_name <span class="sc">%in%</span> <span class="fu">names</span>(normed[[<span class="dv">1</span>]])) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable_name, indicator, index, dimension)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(filtered_frame)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Save this for later - use in regression and variable selection </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(filtered_frame, <span class="st">'data/filtered_frame.rds'</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a list where we hold scores for indicators, indices, and dimensions</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for geometric mean</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>geometric_mean <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>){</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fu">sum</span>(<span class="fu">log</span>(x[x <span class="sc">&gt;</span> <span class="dv">0</span>]), <span class="at">na.rm =</span> na.rm) <span class="sc">/</span> <span class="fu">length</span>(x))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Get indicator scores across all three normalization methods</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>indicator_scores <span class="ot">&lt;-</span> <span class="fu">map</span>(normed, \(df) {</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For each df, calculate indicator means</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  indicators_out <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">unique</span>(filtered_frame<span class="sc">$</span>indicator), \(ind) {</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Column name based on indicator</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    ind_snake <span class="ot">&lt;-</span> ind</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split into groups by indicator, with one or more metrics each</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    variables <span class="ot">&lt;-</span> filtered_frame <span class="sc">%&gt;%</span> </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(indicator <span class="sc">==</span> ind) <span class="sc">%&gt;%</span> </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(variable_name) <span class="sc">%&gt;%</span> </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unique</span>()</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    indicator_metrics <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">all_of</span>(variables))</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get arithmetic and geo means for each indicator</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    dfs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    dfs<span class="sc">$</span>arithmetic <span class="ot">&lt;-</span> indicator_metrics <span class="sc">%&gt;%</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!!</span><span class="fu">sym</span>(ind_snake) <span class="sc">:</span><span class="er">=</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">everything</span>())),</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">!!</span><span class="fu">sym</span>(ind_snake))</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    dfs<span class="sc">$</span>geometric <span class="ot">&lt;-</span> indicator_metrics <span class="sc">%&gt;%</span> </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!!</span><span class="fu">sym</span>(ind_snake) <span class="sc">:</span><span class="er">=</span> <span class="fu">geometric_mean</span>(<span class="fu">c_across</span>(<span class="fu">everything</span>())),</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">!!</span><span class="fu">sym</span>(ind_snake))</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(dfs) </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rearrange so we put each aggregation method (arith, geo) together</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  norm_out <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  norm_out<span class="sc">$</span>arithmetic <span class="ot">&lt;-</span> <span class="fu">map</span>(indicators_out, <span class="sc">~</span> {</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    .x[<span class="fu">grep</span>(<span class="st">"arithmetic"</span>, <span class="fu">names</span>(.x))]</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span> </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>()</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  norm_out<span class="sc">$</span>geometric <span class="ot">&lt;-</span> <span class="fu">map</span>(indicators_out, <span class="sc">~</span> {</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    .x[<span class="fu">grep</span>(<span class="st">"geometric"</span>, <span class="fu">names</span>(.x))]</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span> </span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>()</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(norm_out) </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(indicator_scores, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Index Means:</p>
<div class="cell" data-warnings="false">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For each set of indicator scores, calculate index scores</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get_str(indicator_scores, 4)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">unique</span>(filtered_frame<span class="sc">$</span>index)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose aggregation function based on agg_type</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>agg_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x, agg_type) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (agg_type <span class="sc">==</span> <span class="st">'geometric'</span>) {</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geometric_mean</span>(x)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (agg_type <span class="sc">==</span> <span class="st">'arithmetic'</span>) {</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(x)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>index_scores <span class="ot">&lt;-</span> <span class="fu">map</span>(indicator_scores, \(norm_type) {</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imap</span>(norm_type, \(agg_df, agg_type) {</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(indices, \(index_) {</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get names of indicators for this index</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>      index_indicators <span class="ot">&lt;-</span> filtered_frame <span class="sc">%&gt;%</span> </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(index <span class="sc">==</span> index_) <span class="sc">%&gt;%</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pull</span>(indicator) <span class="sc">%&gt;%</span> </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unique</span>()</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get DF of indicators for this index</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>      index_indicator_df <span class="ot">&lt;-</span> agg_df <span class="sc">%&gt;%</span> </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">all_of</span>(index_indicators))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get arithmetic or geometric mean, based on agg_type</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>      index_indicator_df <span class="sc">%&gt;%</span> </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># mutate(mean = across(everything(), agg_function(agg_type)))</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(index_) <span class="sc">:</span><span class="er">=</span> <span class="fu">agg_function</span>(<span class="fu">c_across</span>(<span class="fu">everything</span>()), agg_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">!!</span><span class="fu">sym</span>(index_))</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span> </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>()</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(index_scores, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dimension Means:</p>
<div class="cell" data-warnings="false">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(index_scores, <span class="dv">4</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Same process for dimensions</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="fu">unique</span>(filtered_frame<span class="sc">$</span>dimension)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>dimension_scores <span class="ot">&lt;-</span> <span class="fu">map</span>(index_scores, \(norm_type) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imap</span>(norm_type, \(agg_df, agg_type) {</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(dimensions, \(dimension_) {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get names of indices for this dimension</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      dimension_indices <span class="ot">&lt;-</span> filtered_frame <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(dimension <span class="sc">==</span> dimension_) <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pull</span>(index) <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unique</span>()</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get DF of indice for this dimension</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      dimension_index_df <span class="ot">&lt;-</span> agg_df <span class="sc">%&gt;%</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">all_of</span>(dimension_indices))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get arithmetic or geometric mean, based on agg_type</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      dimension_index_df <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(dimension_) <span class="sc">:</span><span class="er">=</span> <span class="fu">agg_function</span>(</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c_across</span>(<span class="fu">everything</span>()), </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>          agg_type</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">%&gt;%</span> </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">!!</span><span class="fu">sym</span>(dimension_))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>()</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(dimension_scores, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="wrangle" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Wrangle</h1>
<p>Organize arithmetic and geometric means for each level of the framework (indicator, index, dimension) in a way that is easier to work with.</p>
<div class="cell" data-warnings="false">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  purrr</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(indicator_scores, <span class="dv">4</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(index_scores, <span class="dv">4</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(dimension_scores, <span class="dv">4</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Want to end up with 6 lists: 3 norm types * 2 mean types</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Put them all together in one list to work with</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>all_scores <span class="ot">&lt;-</span> <span class="fu">mget</span>(<span class="fu">c</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">'indicator_scores'</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">'index_scores'</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">'dimension_scores'</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(all_scores, <span class="dv">3</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to pull out the pieces we want</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Also put state names back in as a column and with real names, not codes</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>get_output <span class="ot">&lt;-</span> <span class="cf">function</span>(norm_type, agg_type) {</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get list of each df (dimension, index, indicator) for combo</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  dfs <span class="ot">&lt;-</span> all_scores <span class="sc">%&gt;%</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(\(level) level[[norm_type]]) <span class="sc">%&gt;%</span> </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(\(norm) norm[[agg_type]])</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get state back into a proper column for each df</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">map</span>(dfs, <span class="sc">~</span> {</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">%&gt;%</span> </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Note that we are binding fips back in - this is hinky, note to fix</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        metrics_df <span class="sc">%&gt;%</span> </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rownames_to_column</span>(<span class="st">'fips'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(fips)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(sm_data<span class="sc">$</span>state_key, state, state_code),</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">join_by</span>(fips <span class="sc">==</span> state_code) </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>fips)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co"># All combinations, also a name</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>combos <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'zscore'</span>, <span class="st">'minmax'</span>, <span class="st">'boxcox'</span>), </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'arithmetic'</span>, <span class="st">'geometric'</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">paste0</span>(Var1, <span class="st">'_'</span>, Var2))</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Map to pull them all out</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">map2</span>(combos[[<span class="dv">1</span>]], combos[[<span class="dv">2</span>]], <span class="sc">~</span> {</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_output</span>(.x, .y)</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span> </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(combos<span class="sc">$</span>name))</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(scores, <span class="dv">4</span>)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="do">## Add averages for New England states and US[]</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>final_scores <span class="ot">&lt;-</span> <span class="fu">map</span>(scores, \(method) {</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(method, \(level) {</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mean of every US state and DC</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    us_means <span class="ot">&lt;-</span> level <span class="sc">%&gt;%</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>state) <span class="sc">%&gt;%</span> </span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.list</span>()</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    us_means<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="st">'US_mean'</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Median of every US state and DC</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    us_medians <span class="ot">&lt;-</span> level <span class="sc">%&gt;%</span> </span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>state) <span class="sc">%&gt;%</span> </span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map_dbl</span>(median) <span class="sc">%&gt;%</span> </span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.list</span>()</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    us_medians<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="st">'US_median'</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mean of just New England states</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>    ne_means <span class="ot">&lt;-</span> level <span class="sc">%&gt;%</span> </span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'VT'</span>, <span class="st">'NH'</span>, <span class="st">'ME'</span>, <span class="st">'MA'</span>, <span class="st">'CT'</span>, <span class="st">'RI'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>state) <span class="sc">%&gt;%</span> </span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.list</span>()</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>    ne_means<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="st">'NewEng'</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the level + US + NewEng means</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>    level <span class="sc">%&gt;%</span> </span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(us_means) <span class="sc">%&gt;%</span> </span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(us_medians) <span class="sc">%&gt;%</span> </span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(ne_means)</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a><span class="fu">get_str</span>(final_scores, <span class="dv">4</span>)</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Save this for use elsewhere</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(final_scores, <span class="st">'data/state_score_iterations.rds'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This gives us a list of 6 elements, one for each combination of normalization method and aggregation method. Each element has three data frames, one for indicator, index, and dimension. Now we can compare these 6 outputs to see how the methodological differences affect scores and ranks.</p>
<p>Could consider aggregating the 6 New England states here by population as well? Or by arithmetic / geometric mean. TBD</p>
</section>
<section id="references" class="level1" data-number="7">




</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">7 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-adamudemelash2024MeasuringFoodSystem" class="csl-entry" role="listitem">
Adamu Demelash, Sewareg, and Esubalew Abate Alemu. 2024. <span>“Measuring Food System Sustainability in <span>Ethiopia</span>: <span>Towards</span> a <span>Multi-Dimensional</span> Perspective.”</span> <em>Ecological Indicators</em> 161 (April): 111991. <a href="https://doi.org/10.1016/j.ecolind.2024.111991">https://doi.org/10.1016/j.ecolind.2024.111991</a>.
</div>
<div id="ref-beaujean2013" class="csl-entry" role="listitem">
Beaujean, A. Alexander. 2013. <span>“Factor Analysis Using R.”</span> <a href="https://doi.org/10.7275/Z8WR-4J42">https://doi.org/10.7275/Z8WR-4J42</a>.
</div>
<div id="ref-bene2019GlobalMapIndicators" class="csl-entry" role="listitem">
Béné, Christophe, Steven D. Prager, Harold A. E. Achicanoy, Patricia Alvarez Toro, Lea Lamotte, Camila Bonilla, and Brendan R. Mapes. 2019. <span>“Global Map and Indicators of Food System Sustainability.”</span> <em>Scientific Data</em> 6 (1): 279. <a href="https://doi.org/10.1038/s41597-019-0301-5">https://doi.org/10.1038/s41597-019-0301-5</a>.
</div>
<div id="ref-bickel1981" class="csl-entry" role="listitem">
Bickel, Peter J., and Kjell A. Doksum. 1981. <span>“An Analysis of Transformations Revisited.”</span> <em>Journal of the American Statistical Association</em> 76 (374): 296–311. <a href="https://doi.org/10.1080/01621459.1981.10477649">https://doi.org/10.1080/01621459.1981.10477649</a>.
</div>
<div id="ref-gomez-limon2010EmpiricalEvaluationAgricultural" class="csl-entry" role="listitem">
Gómez-Limón, José A., and Gabriela Sanchez-Fernandez. 2010. <span>“Empirical Evaluation of Agricultural Sustainability Using Composite Indicators.”</span> <em>Ecological Economics</em> 69 (5): 1062–75. <a href="https://doi.org/10.1016/j.ecolecon.2009.11.027">https://doi.org/10.1016/j.ecolecon.2009.11.027</a>.
</div>
<div id="ref-jacobi2020NewUnderstandingEvaluation" class="csl-entry" role="listitem">
Jacobi, Johanna, Stellah Mukhovi, Aymara Llanque, Markus Giger, Adriana Bessa, Christophe Golay, Chinwe Ifejika Speranza, et al. 2020. <span>“A New Understanding and Evaluation of Food Sustainability in Six Different Food Systems in <span>Kenya</span> and <span>Bolivia</span>.”</span> <em>Scientific Reports</em> 10 (1): 19145. <a href="https://doi.org/10.1038/s41598-020-76284-y">https://doi.org/10.1038/s41598-020-76284-y</a>.
</div>
<div id="ref-nicolettiSummaryIndicatorsProduct2000" class="csl-entry" role="listitem">
Nicoletti, Giuseppe. 2000. <span>“Summary <span>Indicators</span> of <span>Product Market Regulation</span> with an <span>Extension</span> to <span>Employment Protection Legislation</span>.”</span> {{OECD Economics Department Working Papers}} 226. Vol. 226. <span>OECD Economics Department Working Papers</span>. <a href="https://doi.org/10.1787/215182844604">https://doi.org/10.1787/215182844604</a>.
</div>
<div id="ref-oecdHandbookConstructingComposite2008" class="csl-entry" role="listitem">
OECD. 2008. <em>Handbook on <span>Constructing Composite Indicators</span>: <span>Methodology</span> and <span>User Guide</span></em>. Paris: <span>Organisation for Economic Co-operation and Development</span>.
</div>
<div id="ref-schneider2023StateFoodSystems" class="csl-entry" role="listitem">
Schneider, Kate R., Jessica Fanzo, Lawrence Haddad, Mario Herrero, Jose Rosero Moncayo, Anna Herforth, Roseline Remans, et al. 2023. <span>“The State of Food Systems Worldwide in the Countdown to 2030.”</span> <em>Nature Food</em> 4 (12): 1090–110. <a href="https://doi.org/10.1038/s43016-023-00885-9">https://doi.org/10.1038/s43016-023-00885-9</a>.
</div>
<div id="ref-stekhovenMissForestNonparametricMissing2012a" class="csl-entry" role="listitem">
Stekhoven, Daniel J., and Peter Bühlmann. 2012. <span>“<span>MissForest</span>—Non-Parametric Missing Value Imputation for Mixed-Type Data.”</span> <em>Bioinformatics</em> 28 (1): 112–18. <a href="https://doi.org/10.1093/bioinformatics/btr597">https://doi.org/10.1093/bioinformatics/btr597</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../pages/metric_distributions.html" class="pagination-link" aria-label="Metric Distributions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Metric Distributions</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../pages/indicator_distributions.html" class="pagination-link" aria-label="Indicator Distributions">
        <span class="nav-page-text">Indicator Distributions</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>